---
import Base from "@/layouts/Base.astro";
import FundamentalAnalysisDashboard from "@/layouts/components/fundamentals/FundamentalAnalysisDashboard";
import {
  getFundamentalMockData,
  getAvailableTickers,
} from "@/test/mocks/fundamentalAnalysis.mock";

export function getStaticPaths() {
  // Get available tickers from mock data
  const tickers = getAvailableTickers();

  return tickers.map((ticker) => ({
    params: { ticker: ticker.toLowerCase() },
  }));
}

const { ticker } = Astro.params;

// Get mock data for the requested ticker
const mockData = getFundamentalMockData(ticker as string);

const title = `${mockData.company.name} (${ticker}) - Fundamental Analysis`;
const description = `Comprehensive fundamental analysis dashboard for ${mockData.company.name} including financial metrics, valuation, and investment insights.`;
---

<Base title={title} description={description} noindex={true}>
  <div class="section container">
    <div class="mx-auto max-w-[1200px]">
      <h1 class="mb-6 text-center text-3xl font-bold">
        {mockData.company.name} Fundamental Analysis
      </h1>

      <div class="fundamental-dashboard-container">
        <FundamentalAnalysisDashboard
          client:load
          data={mockData}
          ticker={ticker}
        />
      </div>
    </div>
  </div>
</Base>

<style>
  .fundamental-dashboard-container {
    display: flex;
    justify-content: center;
    overflow-x: auto;
    padding: 1rem;
  }
</style>
