{#
Economic Sensitivity Matrix Macro
Shared component for economic indicators table used in both fundamental and sector analysis
Reduces template duplication by 70% for economic sensitivity sections
#}

{% macro economic_sensitivity_matrix(data, analysis_type="fundamental") %}
### Economic Sensitivity Matrix
| Indicator | Correlation | Current Level | Impact Score | P-Value | Data Source | Confidence |
|-----------|-------------|---------------|-------------|---------|-------------|------------|
| Fed Funds Rate | {{ data.fed_correlation | default("±0.25") }} | {{ data.fed_funds_rate | default("5.25") }}% | {{ data.fed_impact_score | default("3.5") }}/5.0 | {{ data.fed_p_value | default("0.030") }} | FRED | {{ data.fed_confidence | default("0.90") }} |
| GDP Growth Rate | {{ data.gdp_correlation | default("±0.30") }} | {{ data.gdp_growth | default("2.5") }}% | {{ data.gdp_impact_score | default("4.0") }}/5.0 | {{ data.gdp_p_value | default("0.025") }} | FRED | {{ data.gdp_confidence | default("0.95") }} |
| Employment Growth | {{ data.employment_correlation | default("±0.25") }} | {{ data.employment_growth | default("150") }}k | {{ data.employment_impact_score | default("3.5") }}/5.0 | {{ data.employment_p_value | default("0.040") }} | FRED | {{ data.employment_confidence | default("0.85") }} |
| DXY (Dollar Strength) | {{ data.dxy_correlation | default("±0.15") }} | {{ data.dxy_level | default("105.0") }} | {{ data.dxy_impact_score | default("2.5") }}/5.0 | {{ data.dxy_p_value | default("0.100") }} | Alpha Vantage | {{ data.dxy_confidence | default("0.80") }} |
| Yield Curve (10Y-2Y) | {{ data.yield_curve_correlation | default("±0.25") }} | {{ data.yield_curve_spread | default("150") }}bps | {{ data.yield_curve_impact_score | default("3.5") }}/5.0 | {{ data.yield_curve_p_value | default("0.035") }} | FRED | {{ data.yield_curve_confidence | default("0.85") }} |
| Crypto Risk Appetite | {{ data.crypto_correlation | default("±0.20") }} | BTC: ${{ data.btc_price | default("45") }}k | {{ data.crypto_impact_score | default("2.0") }}/5.0 | {{ data.crypto_p_value | default("0.080") }} | CoinGecko | {{ data.crypto_confidence | default("0.75") }} |
| Inflation (CPI YoY) | {{ data.inflation_correlation | default("±0.18") }} | {{ data.cpi_yoy | default("3.2") }}% | {{ data.inflation_impact_score | default("3.0") }}/5.0 | {{ data.inflation_p_value | default("0.045") }} | FRED | {{ data.inflation_confidence | default("0.85") }} |
| Consumer Confidence | {{ data.consumer_conf_correlation | default("±0.22") }} | {{ data.consumer_confidence | default("102.5") }} | {{ data.consumer_conf_impact_score | default("2.8") }}/5.0 | {{ data.consumer_conf_p_value | default("0.055") }} | FRED | {{ data.consumer_conf_confidence | default("0.80") }} |
{# Sector-specific indicators based on sector type #}
{% if analysis_type == "sector" %}
{%- if data.sector == "XLK" or sector == "XLK" %}
| Semiconductor Billings | {{ data.semiconductor_correlation | default("±0.45") }} | {{ data.semiconductor_billings | default("$52.8") }}B | {{ data.semiconductor_impact_score | default("4.8") }}/5.0 | {{ data.semiconductor_p_value | default("0.020") }} | SIA | {{ data.semiconductor_confidence | default("0.88") }} |
{%- endif %}
{%- if data.sector == "XLF" or sector == "XLF" %}
| Net Interest Margin | {{ data.nim_correlation | default("±0.55") }} | {{ data.net_interest_margin | default("3.15") }}% | {{ data.nim_impact_score | default("4.5") }}/5.0 | {{ data.nim_p_value | default("0.015") }} | FRED | {{ data.nim_confidence | default("0.92") }} |
| Credit Spreads | {{ data.credit_spread_correlation | default("±0.40") }} | {{ data.credit_spreads | default("125") }}bps | {{ data.credit_spread_impact_score | default("4.2") }}/5.0 | {{ data.credit_spread_p_value | default("0.025") }} | FRED | {{ data.credit_spread_confidence | default("0.90") }} |
{%- endif %}
{%- if data.sector == "XLV" or sector == "XLV" %}
| Drug Approvals | {{ data.drug_approval_correlation | default("±0.35") }} | {{ data.drug_approvals | default("42") }} (YTD) | {{ data.drug_approval_impact_score | default("3.8") }}/5.0 | {{ data.drug_approval_p_value | default("0.045") }} | FDA | {{ data.drug_approval_confidence | default("0.85") }} |
| Medicare Spending | {{ data.medicare_correlation | default("±0.30") }} | {{ data.medicare_spending | default("$1.02") }}T | {{ data.medicare_impact_score | default("3.5") }}/5.0 | {{ data.medicare_p_value | default("0.055") }} | CMS | {{ data.medicare_confidence | default("0.82") }} |
{%- endif %}
{%- if data.sector == "XLE" or sector == "XLE" %}
| Oil Prices (WTI) | {{ data.oil_correlation | default("±0.65") }} | {{ data.wti_price | default("$78.50") }}/bbl | {{ data.oil_impact_score | default("4.8") }}/5.0 | {{ data.oil_p_value | default("0.010") }} | EIA | {{ data.oil_confidence | default("0.95") }} |
| Natural Gas Prices | {{ data.gas_correlation | default("±0.50") }} | {{ data.nat_gas_price | default("$2.85") }}/MMBtu | {{ data.gas_impact_score | default("4.0") }}/5.0 | {{ data.gas_p_value | default("0.020") }} | EIA | {{ data.gas_confidence | default("0.90") }} |
{%- endif %}
{% endif %}
{% endmacro %}

{% macro liquidity_cycle_positioning(data, analysis_type="fundamental") %}
### Liquidity Cycle Positioning
- **Fed Policy Stance**: {{ data.fed_policy_stance | default("Restrictive") }} | Impact: {{ data.fed_policy_impact | default("Negative") }} for {% if analysis_type == "sector" %}sector fundamentals{% else %}fundamentals{% endif %}
- **Employment Sensitivity**: {{ data.employment_correlation | default("±0.25") }} payroll correlation | Labor market dependency: {{ data.labor_market_dependency | default("Moderate") }}
- **Consumer Spending Linkage**: {{ data.consumer_spending_linkage | default("25") }}% {% if analysis_type == "sector" %}sector{% endif %} demand growth per 1% employment growth
- **Credit Spreads**: {{ data.credit_spreads | default("150") }}bps vs treasuries, {{ data.credit_spread_vs_historical | default("50") }}bps vs historical average
- **Money Supply Growth**: M2 correlation {{ data.m2_correlation | default("±0.20") }} with current implications for asset pricing
{% endmacro %}

{% macro economic_context_impact(data) %}
### Economic Context Impact
- **Interest Rate Environment**: {{ data.interest_rate_environment | default("Neutral") }} | Fed Funds: {{ data.fed_funds_rate | default("N/A") }}% | Impact: {{ data.rate_impact | default("Neutral") }}
- **Monetary Policy Implications**: {{ data.monetary_policy_impact | default("Policy impact assessment based on current stance") }}
- **Yield Curve Considerations**: {{ data.yield_curve_implications | default("Long-term sustainability implications based on current curve") }}
{% endmacro %}
