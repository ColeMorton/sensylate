{#
Trade History Economic Context Macro
Specialized economic context integration for trading performance analysis
Adapts FRED economic intelligence for trading strategy effectiveness assessment
#}

{% macro trading_economic_context(data) %}
### Economic Context & Market Regime Analysis
**Current Analysis Period**: {{ data.analysis_period | default("YTD 2025") }} | **Market Regime**: {{ data.market_regime | default("Transitional") }}

#### Interest Rate Environment Impact
- **Fed Funds Rate**: {{ data.fed_funds_rate }}% | **Trading Strategy Impact**: {{ data.fed_impact_on_strategies | default("Neutral correlation with crossover strategies") }}
- **10Y-2Y Yield Spread**: {{ data.yield_spread | default("150") }}bps | **Strategy Sensitivity**: {{ data.yield_sensitivity | default("Limited direct impact on technical signals") }}
- **Rate Environment Classification**: {{ data.rate_environment | default("Restrictive") }} | **Performance Correlation**: {{ data.rate_correlation | default("±0.15") }}

#### Market Volatility Regime Assessment
- **Average VIX**: {{ data.avg_vix | default("18.5") }} | **VIX Environment**: {{ data.vix_environment | default("Low-Moderate volatility") }}
- **Strategy Performance by VIX**:
  - **Low VIX (<15)**: {{ data.low_vix_performance | default("Win rate +8% above average") }}
  - **Moderate VIX (15-25)**: {{ data.moderate_vix_performance | default("Baseline performance levels") }}
  - **High VIX (>25)**: {{ data.high_vix_performance | default("Limited sample, -15% performance impact estimated") }}
- **Volatility Correlation**: {{ data.volatility_correlation | default("±0.23") }} with overall portfolio returns

#### Economic Cycle Positioning
- **Business Cycle Phase**: {{ data.business_cycle | default("Mid-cycle expansion") }} | **Strategy Alignment**: {{ data.cycle_alignment | default("Growth-oriented strategies favored") }}
- **GDP Growth Correlation**: {{ data.gdp_correlation | default("±0.18") }} | **Economic Sensitivity**: {{ data.economic_sensitivity | default("Moderate positive correlation with growth") }}
- **Employment Data Impact**: {{ data.employment_impact | default("Limited direct impact on technical signals") }}
{% endmacro %}

{% macro market_regime_performance_matrix(data) %}
### Market Regime Performance Analysis
| Regime | Duration | Win Rate | Avg Return | Risk-Adj Return | Sample Size | Confidence |
|--------|----------|----------|-------------|-----------------|-------------|------------|
| **Low Vol Growth** | {{ data.low_vol_duration | default("45 days") }} | {{ data.low_vol_win_rate | default("68") }}% | {{ data.low_vol_return | default("+12.5") }}% | {{ data.low_vol_sharpe | default("1.85") }} | {{ data.low_vol_sample | default("15") }} | {{ data.low_vol_confidence | default("0.78") }} |
| **High Vol Growth** | {{ data.high_vol_duration | default("30 days") }} | {{ data.high_vol_win_rate | default("55") }}% | {{ data.high_vol_return | default("+8.2") }}% | {{ data.high_vol_sharpe | default("0.95") }} | {{ data.high_vol_sample | default("8") }} | {{ data.high_vol_confidence | default("0.65") }} |
| **Consolidation** | {{ data.consolidation_duration | default("60 days") }} | {{ data.consolidation_win_rate | default("58") }}% | {{ data.consolidation_return | default("+5.1") }}% | {{ data.consolidation_sharpe | default("0.72") }} | {{ data.consolidation_sample | default("12") }} | {{ data.consolidation_confidence | default("0.72") }} |
| **Risk-Off** | {{ data.risk_off_duration | default("15 days") }} | {{ data.risk_off_win_rate | default("45") }}% | {{ data.risk_off_return | default("-2.8") }}% | {{ data.risk_off_sharpe | default("0.25") }} | {{ data.risk_off_sample | default("3") }} | {{ data.risk_off_confidence | default("0.45") }} |

**Economic Context Insights**:
- **Optimal Conditions**: {{ data.optimal_conditions | default("Low volatility growth environments with VIX <20") }}
- **Challenge Periods**: {{ data.challenge_periods | default("High volatility risk-off periods with economic uncertainty") }}
- **Strategy Adaptation**: {{ data.strategy_adaptation | default("Dynamic allocation based on volatility regime classification") }}
{% endmacro %}

{% macro economic_stress_testing(data) %}
### Economic Scenario Stress Testing
**Base Case** ({{ data.base_case_probability | default("60") }}% probability):
- **Economic Conditions**: {{ data.base_case_conditions | default("Moderate growth, stable policy, normal volatility") }}
- **Expected Performance**: {{ data.base_case_performance | default("Win rate 60-65%, Sharpe 1.2-1.5") }}
- **Strategy Allocation**: {{ data.base_case_allocation | default("Standard 70% SMA / 30% EMA allocation") }}

**Favorable Scenario** ({{ data.favorable_probability | default("25") }}% probability):
- **Economic Conditions**: {{ data.favorable_conditions | default("Strong growth, accommodative policy, low volatility") }}
- **Expected Performance**: {{ data.favorable_performance | default("Win rate 70%+, Sharpe 1.8+") }}
- **Strategy Optimization**: {{ data.favorable_optimization | default("Increase position sizes, favor trend-following") }}

**Adverse Scenario** ({{ data.adverse_probability | default("15") }}% probability):
- **Economic Conditions**: {{ data.adverse_conditions | default("Recession, policy uncertainty, high volatility") }}
- **Expected Performance**: {{ data.adverse_performance | default("Win rate 45-50%, Sharpe 0.3-0.6") }}
- **Risk Management**: {{ data.adverse_risk_management | default("Reduce position sizes, increase cash allocation") }}

**Recovery Timeline**: {{ data.recovery_timeline | default("3-5 trades average to recover from adverse conditions") }}
{% endmacro %}

{% macro sector_economic_sensitivity(data) %}
### Sector Performance & Economic Correlation
#### Technology Sector Analysis ({{ data.tech_weight | default("47") }}% of portfolio)
- **Economic Sensitivity**: {{ data.tech_economic_correlation | default("±0.25 correlation with GDP growth") }}
- **Interest Rate Impact**: {{ data.tech_rate_impact | default("Moderate negative correlation with rising rates") }}
- **Performance During Analysis**: {{ data.tech_performance | default("77.8% win rate, significant outperformance") }}

#### Defensive Sectors ({{ data.defensive_weight | default("25") }}% of portfolio)
- **Economic Resilience**: {{ data.defensive_resilience | default("Lower volatility during economic stress") }}
- **Policy Sensitivity**: {{ data.defensive_policy_impact | default("Healthcare affected by regulatory environment") }}
- **Rotation Indicators**: {{ data.defensive_rotation | default("Defensive positioning during late-cycle periods") }}

#### Cyclical Exposure ({{ data.cyclical_weight | default("28") }}% of portfolio)
- **Economic Leverage**: {{ data.cyclical_leverage | default("Higher beta to economic cycle performance") }}
- **Leading Indicators**: {{ data.cyclical_indicators | default("Industrial production, manufacturing PMI correlation") }}
- **Cycle Timing**: {{ data.cyclical_timing | default("Early positioning in economic acceleration phases") }}
{% endmacro %}
